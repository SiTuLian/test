<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0">
	<link rel="stylesheet" type="text/css" href="../public/bootstrap.min.css">
	<script type="text/javascript" src="../public/jquery-3.3.1.min.js"></script>
	<title>特效一</title>
	<style type="text/css">
		*{
			margin: 0;
			position: absolute;

		}
	</style>
</head>
<body>
	<canvas id="canvas" width="1000" height="600" style="border: 1px solid #333;">您的浏览器不支持canvas，请换一个！</canvas>

	<script type="text/javascript">

		var time = null;//定时器变量
		var canvas = document.getElementById('canvas');
		var draw = canvas.getContext('2d');

		var deg = 360*Math.PI/180;

		var jiao = -1;//圆滚动和渐变圆出现的参数，角度越大，圆越完整

		//根据传入的弧度，计算当动圆的坐标
		var wh = {
			funWidth:function (jiaoDu){

				var cos_jiaoDu = Math.cos(jiaoDu);
				
				var w = 300+cos_jiaoDu*105;

				return w;
			},
			funHeight:function(jiaoDu){

				var sin_jiaoDu = Math.sin(jiaoDu);

				var h = 150-sin_jiaoDu*105;

				return h;
			}
			
		}

		//一个固定的大圆和小圆
		var draw_yuan = {
			guding:function(deg){

				draw.beginPath()
				draw.arc(300,150,100,0,deg,false);
				draw.fillStyle = "gray";
				draw.closePath();
				draw.stroke();
				draw.fill();

				draw.beginPath()
				draw.fillStyle = "blue";
				draw.arc(405,150,5,0,deg,false);
				draw.closePath();
				draw.stroke();
				draw.fill();
			}
		}
		
		//事先把大圆和小圆画出来
		draw_yuan.guding(deg);
		draw.beginPath();
		draw.arc(405,150,5,0,deg,false);
		draw.fillStyle = "red";
		draw.closePath();
		draw.stroke();
		draw.fill();

		
		/*
			bool ------- true ------- 开始逆时针滚动 角度为360时停止
			bool ------- false ------- 回退 角度为0时停止
		*/
		function draw_animat(bool){



			if (bool) {

				++jiao;//逆时
			}else{
				--jiao;//回退
			}
			//如果动圆的在初始位置，则回退无效，退出函数
			if(bool==false && jiao == -2){
				jiao = -1;
				return 0;
			}

			//清除指定区域的画布
			draw.clearRect(0,0,420,270);

			//弧度转换
			var deg_jiao = jiao*Math.PI/180;

			//渐变圆，线性渐变
			var grd=draw.createLinearGradient(200,150,410,150);

			draw.beginPath();

			//渐变的颜色
			grd.addColorStop(0,"#23415d");
			grd.addColorStop(0.1,"#454682");
			grd.addColorStop(0.2,"#abcdef");
			grd.addColorStop(0.3,"#957156");
			grd.addColorStop(0.4,"#753453");
			grd.addColorStop(0.5,"#142546");
			grd.addColorStop(0.6,"#863424");
			grd.addColorStop(0.7,"#543236");
			grd.addColorStop(0.8,"#44f352");
			grd.addColorStop(0.9,"#14245d");
			grd.addColorStop(1,"#534643");

			draw.moveTo(300,150);
			draw.arc(300,150,110,0,-deg_jiao,true);
			draw.fillStyle = grd;
			draw.closePath();
			draw.stroke();
			draw.fill();

			//固定的大圆和小圆
			draw_yuan.guding(deg);

			//获取动圆的坐标
			var w = wh.funWidth(deg_jiao);
			var h = wh.funHeight(deg_jiao);
			
			//动圆
			draw.beginPath();
			draw.arc(w,h,5,0,deg,false);
			draw.fillStyle = "red";
			draw.closePath();
			draw.stroke();
			draw.fill();

			

			//清除定时器
			if (jiao>=360 && bool==true) {
				clearInterval(time);
				time = null;
			}
			if (jiao<=0 && bool==false) {
				clearInterval(time);
				time = null;
				jiao = -1;
			}
			
		}

		//绘制按钮
		function draw_button(x,y,text){
			draw.clearRect(x,y,50,30)
			draw.beginPath();
			draw.strokeRect(x,y,50,30);
			draw.font="18px Georgia";
			var tx = x+6;
			var ty = y+20;
			draw.strokeText(text,tx,ty);
			draw.closePath();
		}
		draw_button(220,300,"前进");
		draw_button(290,300,"回退");
		draw_button(360,300,"停止");

		//绘制拥有背景色的按钮
		function again_draw_button(x,y,text){

			draw.clearRect(x,y,50,30)
			draw.beginPath();
			draw.fillStyle = "#33ffff";
			draw.fillRect(x,y,50,30);
			draw.font="18px Georgia";
			var tx = x+6;
			var ty = y+20;
			draw.strokeText(text,tx,ty);
			draw.closePath();
		}
		

		

		var movex, movey;//鼠标的坐标

		//
		function mousemove(e){

	       e=e  || window.event;
	       if(e.pageX || e.pageY){
                movex=e.pageX;//获得鼠标的横坐标
                movey=e.pageY;//获得鼠标的纵坐标
	       }

	       if (movex>=220 && movex<=270 && movey>=300 && movey<=330) {
	       		
	       		again_draw_button(220,300,"前进");
	       		canvas.style.cursor = "pointer";
	       }else if (movex>=290 && movex<=340 && movey>=300 && movey<=330) {
	       		
	       		again_draw_button(290,300,"回退");
	       		canvas.style.cursor = "pointer";
	       }else if (movex>=360 && movex<=410 && movey>=300 && movey<=330) {
	       		again_draw_button(360,300,"停止");
	       		canvas.style.cursor = "pointer";
	       }else{
	       		draw_button(220,300,"前进");
	       		draw_button(290,300,"回退");
	       		draw_button(360,300,"停止");
	       		canvas.style.cursor = "default";
	       }
		                
		} 
		//给画布绑定鼠标移动事件
		canvas.onmousemove = mousemove;
		

		//给画布绑定鼠标点击事件
		canvas.addEventListener('click', function(){
  			if (movex>=220 && movex<=270 && movey>=300 && movey<=330) {
	       		
	       		if (time) {
	       			clearInterval(time);
					time = null;
	       		}
	       		time = setInterval("draw_animat(true)",50);
	       }else if (movex>=290 && movex<=340 && movey>=300 && movey<=330) {
	       		if (time) {
	       			clearInterval(time);
					time = null;
	       		}
	       		time = setInterval("draw_animat(false)",50);
	       }else if (movex>=360 && movex<=410 && movey>=300 && movey<=330) {
	       		clearInterval(time);
				time = null;
	       }
  			
		}, false);



		


	</script>
</body>
</html>